---
import Layout from "@/layouts/Layout.astro"

import Hero from "@/components/Hero.astro"
import AnimatedProjects from "@/components/AnimatedProjects"
import AnimatedExperience from "@/components/AnimatedExperience"
import AnimatedEducation from "@/components/AnimatedEducation"
import AnimatedSection from "@/components/AnimatedSection"
import AboutMe from "@/components/AboutMe.astro"
import Contact from "@/components/Contact.astro"
import OpenSource from "@/components/OpenSource.astro"
import SectionContainer from "@/components/SectionContainer.astro"

import { useTranslations, type Lang } from "@/i18n"
import { getProjects } from "@/i18n/data/projects"
import { getExperience, getEducation } from "@/i18n/data/experience"

export function getStaticPaths() {
  return [{ params: { lang: "en" } }, { params: { lang: "es" } }]
}

const lang = Astro.params.lang as Lang
const t = useTranslations(lang)

const projects = getProjects(lang)
const serializedProjects = projects.map((p) => ({
  ...p,
  tags: p.tags.map((tag) => ({ name: tag.name, class: tag.class })),
}))

const experience = getExperience(lang)
const education = getEducation(lang)
---

<Layout
  title={t("meta.title")}
  description={t("meta.description")}
  lang={lang}
>
  <main id="main-content" class="px-4">
    <SectionContainer class="py-16 md:py-28">
      <Hero lang={lang} />
    </SectionContainer>

    <div class="space-y-20">
      <SectionContainer id="projects">
        <AnimatedSection client:visible>
          <h2 class="text-3xl font-bold text-foreground tracking-tight flex items-center gap-2"><span class="inline-block w-2 h-2 rounded-full bg-primary animate-glow-pulse"></span>{t("section.projects")}</h2>
          <p class="mt-1 text-sm text-muted-foreground">{t("section.projects.subtitle")}</p>
        </AnimatedSection>
        <div class="mt-8">
          <AnimatedProjects client:visible projects={serializedProjects} />
        </div>
      </SectionContainer>

      <SectionContainer id="open-source">
        <AnimatedSection client:visible>
          <h2 class="text-3xl font-bold text-foreground tracking-tight flex items-center gap-2"><span class="inline-block w-2 h-2 rounded-full bg-primary animate-glow-pulse"></span>{t("section.opensource")}</h2>
          <p class="mt-1 text-sm text-muted-foreground">{t("section.opensource.subtitle")}</p>
        </AnimatedSection>
        <div class="mt-8">
          <OpenSource lang={lang} />
        </div>
      </SectionContainer>

      <SectionContainer id="experience">
        <AnimatedSection client:visible>
          <h2 class="text-3xl font-bold text-foreground tracking-tight flex items-center gap-2"><span class="inline-block w-2 h-2 rounded-full bg-primary animate-glow-pulse"></span>{t("section.experience")}</h2>
          <p class="mt-1 text-sm text-muted-foreground">{t("section.experience.subtitle")}</p>
        </AnimatedSection>
        <div class="mt-8">
          <AnimatedExperience client:visible experience={experience} connectorText={t("connector.at")} />
        </div>
      </SectionContainer>

      <SectionContainer id="education">
        <AnimatedSection client:visible>
          <h2 class="text-3xl font-bold text-foreground tracking-tight flex items-center gap-2"><span class="inline-block w-2 h-2 rounded-full bg-primary animate-glow-pulse"></span>{t("section.education")}</h2>
          <p class="mt-1 text-sm text-muted-foreground">{t("section.education.subtitle")}</p>
        </AnimatedSection>
        <div class="mt-8">
          <AnimatedEducation client:visible education={education} connectorText={t("connector.at")} />
        </div>
      </SectionContainer>

      <SectionContainer id="about-me">
        <AnimatedSection client:visible>
          <h2 class="text-3xl font-bold text-foreground tracking-tight flex items-center gap-2"><span class="inline-block w-2 h-2 rounded-full bg-primary animate-glow-pulse"></span>{t("section.about")}</h2>
          <p class="mt-1 text-sm text-muted-foreground">{t("section.about.subtitle")}</p>
        </AnimatedSection>
        <div class="mt-8">
          <AboutMe lang={lang} />
        </div>
      </SectionContainer>

      <SectionContainer id="contact">
        <AnimatedSection client:visible>
          <h2 class="text-3xl font-bold text-foreground tracking-tight text-center">{t("section.contact")}</h2>
          <p class="mt-1 text-sm text-muted-foreground text-center">{t("section.contact.subtitle")}</p>
        </AnimatedSection>
        <div class="mt-8">
          <Contact lang={lang} />
        </div>
      </SectionContainer>
    </div>
  </main>
</Layout>
